<div class="update-rapport-container">
  <header class="form-header">
    <h2>Player Performance Report</h2>
    <div class="form-icon">ğŸ†</div>
  </header>

  <form [formGroup]="rapportForm" (ngSubmit)="updateRapport()">
    <div class="progress-container">
      <div class="progress-bar">
        <div class="progress" [style.width.%]="getProgressPercentage()"></div>
      </div>
      <div class="progress-steps">
        <span class="step" [class.active]="currentSection === 'performance'">1</span>
        <span class="step" [class.active]="currentSection === 'strength'">2</span>
        <span class="step" [class.active]="currentSection === 'agility'">3</span>
        <span class="step" [class.active]="currentSection === 'state'">4</span>
      </div>
    </div>

    <!-- PERFORMANCE -->
    <div class="form-section" *ngIf="currentSection === 'performance'">
      <h3>Performance Metrics <span class="section-icon">âš¡</span></h3>
      
      <ng-container *ngFor="let field of ['speedRapport', 'accelerationRapport', 'endurance']">
        <div class="form-group">
          <label [for]="field">{{ field | titlecase }}:</label>
          <input
            [id]="field"
            [formControlName]="field"
            type="text"
            placeholder="Enter {{ field | titlecase }} value"
            (keypress)="allowOnlyNumbers($event)"
          />
          <div *ngIf="rapportForm.get(field)?.invalid && rapportForm.get(field)?.touched" class="error-message">
            Please enter a valid number between 0 and 100.
          </div>
        </div>
      </ng-container>
    </div>

    <!-- STRENGTH -->
    <div class="form-section" *ngIf="currentSection === 'strength'">
      <h3>Strength Assessment <span class="section-icon">ğŸ’ª</span></h3>

      <ng-container *ngFor="let field of ['muscularEndurance', 'aerobicCapacity', 'anaerobicCapacity', 'strength', 'power', 'explosiveness']">
        <div class="form-group">
          <label [for]="field">{{ field | titlecase }}:</label>
          <input
            [id]="field"
            [formControlName]="field"
            type="text"
            placeholder="Enter {{ field | titlecase }} value"
            (keypress)="allowOnlyNumbers($event)"
          />
          <div *ngIf="rapportForm.get(field)?.invalid && rapportForm.get(field)?.touched" class="error-message">
            Please enter a valid number between 0 and 100.
          </div>
        </div>
      </ng-container>
    </div>

    <!-- AGILITY -->
    <div class="form-section" *ngIf="currentSection === 'agility'">
      <h3>Agility & Coordination <span class="section-icon">ğŸƒ</span></h3>

      <ng-container *ngFor="let field of ['agility', 'balance', 'coordination', 'reactionTime', 'reactivity', 'verticalJump', 'horizontalJump']">
        <div class="form-group">
          <label [for]="field">{{ field | titlecase }}:</label>
          <input
            [id]="field"
            [formControlName]="field"
            type="text"
            placeholder="Enter {{ field | titlecase }} value"
            (keypress)="allowOnlyNumbers($event)"
          />
          <div *ngIf="rapportForm.get(field)?.invalid && rapportForm.get(field)?.touched" class="error-message">
            Please enter a valid number between 0 and 100.
          </div>
        </div>
      </ng-container>
    </div>

    <!-- STATE -->
    <div class="form-section" *ngIf="currentSection === 'state'">
      <h3>Player Status <span class="section-icon">ğŸ¥</span></h3>

      <div class="form-group">
        <label for="etatRapport">Report State:</label>
        <select id="etatRapport" formControlName="etatRapport" class="status-select">
          <option value="" disabled>Select status</option>
          <option *ngFor="let option of etatOptions" [value]="option">{{ option }}</option>
        </select>
        <div *ngIf="etatRapport?.invalid && etatRapport?.touched" class="error-message">
          Please select a status.
        </div>
      </div>

      <div class="form-group">
        <label for="blessureRapport">Injury Level:</label>
        <select id="blessureRapport" formControlName="blessureRapport" class="injury-select">
          <option value="" disabled>Select injury level</option>
          <option *ngFor="let option of blessureOptions" [value]="option">{{ option }}</option>
        </select>
        <div *ngIf="blessureRapport?.invalid && blessureRapport?.touched" class="error-message">
          Please select an injury level.
        </div>
      </div>
    </div>

    <!-- BUTTONS -->
    <div class="button-container">
      <button type="button" class="btn-previous" (click)="prevSection()" [disabled]="currentSection === 'performance'">
        <span class="btn-icon">â—€</span> Previous
      </button>

      <button type="button" class="btn-next" (click)="nextSection()" *ngIf="currentSection !== 'state'">
        Next <span class="btn-icon">â–¶</span>
      </button>

      <button type="submit" class="btn-submit" [disabled]="!rapportForm.valid" *ngIf="currentSection === 'state'">
        Update Report <span class="btn-icon">âœ“</span>
      </button>
    </div>
  </form>
</div>
