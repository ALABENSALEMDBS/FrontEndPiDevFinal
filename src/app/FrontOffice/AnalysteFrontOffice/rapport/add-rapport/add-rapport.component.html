<div class="report-form-container">
  <div class="form-header">
    <h2>Ajouter un Rapport de Performance</h2>
    <button class="close-btn" (click)="avoidAdd()" aria-label="Fermer">‚úñ</button>
  </div>

  <div class="progress-container">
    <div class="progress-steps">
      <div class="step" [class.active]="currentSection === 'performance'" (click)="goToSection('performance')">
        <div class="step-icon">‚ö°</div>
        <span>Performance</span>
      </div>
      <div class="step" [class.active]="currentSection === 'strength'" (click)="goToSection('strength')">
        <div class="step-icon">üí™</div>
        <span>Force</span>
      </div>
      <div class="step" [class.active]="currentSection === 'agility'" (click)="goToSection('agility')">
        <div class="step-icon">üèÉ</div>
        <span>Agilit√©</span>
      </div>
      <div class="step" [class.active]="currentSection === 'state'" (click)="goToSection('state')">
        <div class="step-icon">üè•</div>
        <span>√âtat</span>
      </div>
    </div>
    <div class="progress-bar-container">
      <div class="progress-bar" [style.width.%]="getProgressPercentage()"></div>
    </div>
  </div>

  <form [formGroup]="rapportForm" (ngSubmit)="addRapport()">
    <!-- Player Selection -->
    <div class="player-selection">
      <div class="form-group">
        <label for="numeroJoueur">Num√©ro du Joueur</label>
        <input 
          id="numeroJoueur" 
          formControlName="numeroJoueur" 
          type="number" 
          class="form-control" 
          placeholder="Entrez le num√©ro du joueur" 
          required 
        />
      </div>
    </div>

    <!-- Performance Section -->
    <div *ngIf="currentSection === 'performance'" class="form-section">
      <h3>Performance <span class="section-badge">1/4</span></h3>
      
      <div class="stats-grid">
        <div class="form-group">
          <label for="speedRapport">Vitesse</label>
          <div class="stat-input-container">
            <input 
              id="speedRapport" 
              formControlName="speedRapport" 
              type="number" 
              class="form-control" 
              min="0" 
              max="100" 
              placeholder="0-100" 
              required 
            />
            <div class="stat-value" *ngIf="rapportForm.get('speedRapport')?.value">
            </div>
          </div>
          <div class="stat-bar" *ngIf="rapportForm.get('speedRapport')?.value">
            <div class="stat-fill" [style.width.%]="rapportForm.get('speedRapport')?.value"></div>
          </div>
        </div>

        <div class="form-group">
          <label for="accelerationRapport">Acc√©l√©ration</label>
          <div class="stat-input-container">
            <input 
              id="accelerationRapport" 
              formControlName="accelerationRapport" 
              type="number" 
              class="form-control" 
              min="0" 
              max="100" 
              placeholder="0-100" 
              required 
            />
            <div class="stat-value" *ngIf="rapportForm.get('accelerationRapport')?.value">
              {{ rapportForm.get('accelerationRapport')?.value }}
            </div>
          </div>
          <div class="stat-bar" *ngIf="rapportForm.get('accelerationRapport')?.value">
            <div class="stat-fill" [style.width.%]="rapportForm.get('accelerationRapport')?.value"></div>
          </div>
        </div>

        <div class="form-group">
          <label for="endurance">Endurance</label>
          <div class="stat-input-container">
            <input 
              id="endurance" 
              formControlName="endurance" 
              type="number" 
              class="form-control" 
              min="0" 
              max="100" 
              placeholder="0-100" 
              required 
            />
            <div class="stat-value" *ngIf="rapportForm.get('endurance')?.value">
            </div>
          </div>
          <div class="stat-bar" *ngIf="rapportForm.get('endurance')?.value">
            <div class="stat-fill" [style.width.%]="rapportForm.get('endurance')?.value"></div>
          </div>
        </div>

        <div class="form-group">
          <label for="muscularEndurance">Endurance Musculaire</label>
          <div class="stat-input-container">
            <input 
              id="muscularEndurance" 
              formControlName="muscularEndurance" 
              type="number" 
              class="form-control" 
              min="0" 
              max="100" 
              placeholder="0-100" 
              required 
            />
            <div class="stat-value" *ngIf="rapportForm.get('muscularEndurance')?.value">
            </div>
          </div>
          <div class="stat-bar" *ngIf="rapportForm.get('muscularEndurance')?.value">
            <div class="stat-fill" [style.width.%]="rapportForm.get('muscularEndurance')?.value"></div>
          </div>
        </div>

        <div class="form-group">
          <label for="aerobicCapacity">Capacit√© A√©robique</label>
          <div class="stat-input-container">
            <input 
              id="aerobicCapacity" 
              formControlName="aerobicCapacity" 
              type="number" 
              class="form-control" 
              min="0" 
              max="100" 
              placeholder="0-100" 
              required 
            />
            <div class="stat-value" *ngIf="rapportForm.get('aerobicCapacity')?.value">
            </div>
          </div>
          <div class="stat-bar" *ngIf="rapportForm.get('aerobicCapacity')?.value">
            <div class="stat-fill" [style.width.%]="rapportForm.get('aerobicCapacity')?.value"></div>
          </div>
        </div>

        <div class="form-group">
          <label for="anaerobicCapacity">Capacit√© Ana√©robique</label>
          <div class="stat-input-container">
            <input 
              id="anaerobicCapacity" 
              formControlName="anaerobicCapacity" 
              type="number" 
              class="form-control" 
              min="0" 
              max="100" 
              placeholder="0-100" 
              required 
            />
            <div class="stat-value" *ngIf="rapportForm.get('anaerobicCapacity')?.value">
            </div>
          </div>
          <div class="stat-bar" *ngIf="rapportForm.get('anaerobicCapacity')?.value">
            <div class="stat-fill" [style.width.%]="rapportForm.get('anaerobicCapacity')?.value"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Strength Section -->
    <div *ngIf="currentSection === 'strength'" class="form-section">
      <h3>Force <span class="section-badge">2/4</span></h3>
      
      <div class="stats-grid">
        <div class="form-group">
          <label for="strength">Force</label>
          <div class="stat-input-container">
            <input 
              id="strength" 
              formControlName="strength" 
              type="number" 
              class="form-control" 
              min="0" 
              max="100" 
              placeholder="0-100" 
              required 
            />
            <div class="stat-value" *ngIf="rapportForm.get('strength')?.value">
            </div>
          </div>
          <div class="stat-bar" *ngIf="rapportForm.get('strength')?.value">
            <div class="stat-fill" [style.width.%]="rapportForm.get('strength')?.value"></div>
          </div>
        </div>

        <div class="form-group">
          <label for="power">Puissance</label>
          <div class="stat-input-container">
            <input 
              id="power" 
              formControlName="power" 
              type="number" 
              class="form-control" 
              min="0" 
              max="100" 
              placeholder="0-100" 
              required 
            />
            <div class="stat-value" *ngIf="rapportForm.get('power')?.value">
            </div>
          </div>
          <div class="stat-bar" *ngIf="rapportForm.get('power')?.value">
            <div class="stat-fill" [style.width.%]="rapportForm.get('power')?.value"></div>
          </div>
        </div>

        <div class="form-group">
          <label for="explosiveness">Explosivit√©</label>
          <div class="stat-input-container">
            <input 
              id="explosiveness" 
              formControlName="explosiveness" 
              type="number" 
              class="form-control" 
              min="0" 
              max="100" 
              placeholder="0-100" 
              required 
            />
            <div class="stat-value" *ngIf="rapportForm.get('explosiveness')?.value">
            </div>
          </div>
          <div class="stat-bar" *ngIf="rapportForm.get('explosiveness')?.value">
            <div class="stat-fill" [style.width.%]="rapportForm.get('explosiveness')?.value"></div>
          </div>
        </div>

        <div class="form-group">
          <label for="verticalJump">Saut Vertical</label>
          <div class="stat-input-container">
            <input 
              id="verticalJump" 
              formControlName="verticalJump" 
              type="number" 
              class="form-control" 
              min="0" 
              max="100" 
              placeholder="0-100" 
              required 
            />
            <div class="stat-value" *ngIf="rapportForm.get('verticalJump')?.value">
            </div>
          </div>
          <div class="stat-bar" *ngIf="rapportForm.get('verticalJump')?.value">
            <div class="stat-fill" [style.width.%]="rapportForm.get('verticalJump')?.value"></div>
          </div>
        </div>

        <div class="form-group">
          <label for="horizontalJump">Saut Horizontal</label>
          <div class="stat-input-container">
            <input 
              id="horizontalJump" 
              formControlName="horizontalJump" 
              type="number" 
              class="form-control" 
              min="0" 
              max="100" 
              placeholder="0-100" 
              required 
            />
            <div class="stat-value" *ngIf="rapportForm.get('horizontalJump')?.value">
            </div>
          </div>
          <div class="stat-bar" *ngIf="rapportForm.get('horizontalJump')?.value">
            <div class="stat-fill" [style.width.%]="rapportForm.get('horizontalJump')?.value"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Agility Section -->
    <div *ngIf="currentSection === 'agility'" class="form-section">
      <h3>Agilit√© <span class="section-badge">3/4</span></h3>
      
      <div class="stats-grid">
        <div class="form-group">
          <label for="agility">Agilit√©</label>
          <div class="stat-input-container">
            <input 
              id="agility" 
              formControlName="agility" 
              type="number" 
              class="form-control" 
              min="0" 
              max="100" 
              placeholder="0-100" 
              required 
            />
            <div class="stat-value" *ngIf="rapportForm.get('agility')?.value">
            </div>
          </div>
          <div class="stat-bar" *ngIf="rapportForm.get('agility')?.value">
            <div class="stat-fill" [style.width.%]="rapportForm.get('agility')?.value"></div>
          </div>
        </div>

        <div class="form-group">
          <label for="balance">√âquilibre</label>
          <div class="stat-input-container">
            <input 
              id="balance" 
              formControlName="balance" 
              type="number" 
              class="form-control" 
              min="0" 
              max="100" 
              placeholder="0-100" 
              required 
            />
            <div class="stat-value" *ngIf="rapportForm.get('balance')?.value">
            </div>
          </div>
          <div class="stat-bar" *ngIf="rapportForm.get('balance')?.value">
            <div class="stat-fill" [style.width.%]="rapportForm.get('balance')?.value"></div>
          </div>
        </div>

        <div class="form-group">
          <label for="coordination">Coordination</label>
          <div class="stat-input-container">
            <input 
              id="coordination" 
              formControlName="coordination" 
              type="number" 
              class="form-control" 
              min="0" 
              max="100" 
              placeholder="0-100" 
              required 
            />
            <div class="stat-value" *ngIf="rapportForm.get('coordination')?.value">
            </div>
          </div>
          <div class="stat-bar" *ngIf="rapportForm.get('coordination')?.value">
            <div class="stat-fill" [style.width.%]="rapportForm.get('coordination')?.value"></div>
          </div>
        </div>

        <div class="form-group">
          <label for="reactionTime">Temps de R√©action</label>
          <div class="stat-input-container">
            <input 
              id="reactionTime" 
              formControlName="reactionTime" 
              type="number" 
              class="form-control" 
              min="0" 
              max="100" 
              placeholder="0-100" 
              required 
            />
            <div class="stat-value" *ngIf="rapportForm.get('reactionTime')?.value">
            </div>
          </div>
          <div class="stat-bar" *ngIf="rapportForm.get('reactionTime')?.value">
            <div class="stat-fill" [style.width.%]="rapportForm.get('reactionTime')?.value"></div>
          </div>
        </div>

        <div class="form-group">
          <label for="reactivity">R√©activit√©</label>
          <div class="stat-input-container">
            <input 
              id="reactivity" 
              formControlName="reactivity" 
              type="number" 
              class="form-control" 
              min="0" 
              max="100" 
              placeholder="0-100" 
              required 
            />
            <div class="stat-value" *ngIf="rapportForm.get('reactivity')?.value">
            </div>
          </div>
          <div class="stat-bar" *ngIf="rapportForm.get('reactivity')?.value">
            <div class="stat-fill" [style.width.%]="rapportForm.get('reactivity')?.value"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- State Section -->
    <div *ngIf="currentSection === 'state'" class="form-section">
      <h3>√âtat <span class="section-badge">4/4</span></h3>
      
      <div class="stats-grid">
        <div class="form-group status-group">
          <label for="etatRapport">√âtat du Joueur</label>
          <select 
            id="etatRapport" 
            formControlName="etatRapport" 
            class="form-control status-select" 
            required
          >
            <option value="" disabled selected>S√©lectionnez un √©tat</option>
            <option *ngFor="let etat of etatOptions" [value]="etat" [ngClass]="getStatusClass(etat)">
              {{ etat }}
            </option>
          </select>
          <div class="status-indicator" *ngIf="rapportForm.get('etatRapport')?.value" 
               [class]="getStatusClass(rapportForm.get('etatRapport')?.value)">
            {{ rapportForm.get('etatRapport')?.value }}
          </div>
        </div>

        <div class="form-group status-group">
          <label for="blessureRapport">Niveau de Blessure</label>
          <select 
            id="blessureRapport" 
            formControlName="blessureRapport" 
            class="form-control injury-select" 
            required
          >
            <option value="" disabled selected>S√©lectionnez un niveau</option>
            <option *ngFor="let blessure of blessureOptions" [value]="blessure" [ngClass]="getInjuryClass(blessure)">
              {{ blessure }}
            </option>
          </select>
          <div class="status-indicator" *ngIf="rapportForm.get('blessureRapport')?.value" 
               [class]="getInjuryClass(rapportForm.get('blessureRapport')?.value)">
            {{ rapportForm.get('blessureRapport')?.value }}
          </div>
        </div>
      </div>
    </div>

    <!-- Navigation Controls -->
    <div class="form-navigation">
      <button 
        type="button" 
        class="btn btn-previous" 
        (click)="prevSection()" 
        [disabled]="currentSection === 'performance'"
      >
        <span class="btn-icon">‚óÄ</span> Pr√©c√©dent
      </button>
      
      <button 
        *ngIf="currentSection === 'state'" 
        type="submit" 
        class="btn btn-submit" 
        [disabled]="!rapportForm.valid"
      >
        Valider <span class="btn-icon">‚öΩ</span>
      </button>
    </div>
  </form>

  <div *ngIf="successMessage" class="alert alert-success">
    <div class="alert-icon">‚úì</div>
    {{ successMessage }}
  </div>

  <div *ngIf="errorMessage" class="alert alert-danger">
    <div class="alert-icon">‚ö†</div>
    {{ errorMessage }}
  </div>
</div>

<!-- Add floating next button for quick navigation -->
<button 
  *ngIf="currentSection !== 'state'" 
  class="floating-next" 
  (click)="nextSection()" 
  title="Section suivante"
>
  <span class="btn-icon">‚ñ∂</span>
</button>

